<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>نسخة كاملة محسنة</title>
<style>
:root {
  --accent: #ff8c00; /* اللون الابتدائي برتقالي */
  --accent-hover: #ff8c00;
}
body {
  margin: 0;
  font-family: sans-serif;
  background: #111;
  color: #fff;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100vh;
  overflow: hidden;
}
#avatar-container {
  position: relative;
  display: inline-block;
  border: 5px solid var(--accent);
  border-radius: 15px;
  overflow: hidden;
  transition: border 0.5s;
}
#avatar {
  display: block;
  width: 300px;
  height: 300px;
  object-fit: cover;
  transform: scale(1);
  transition: transform 0.3s;
}
#size-display {
  margin-top: 5px;
  text-align: center;
}
#controls {
  margin-top: 20px;
  display: flex;
  flex-direction: column;
  gap: 10px;
  align-items: center;
}
input[type=range] {
  width: 200px;
}
button {
  padding: 10px 15px;
  border: none;
  background: var(--accent);
  color: #111;
  border-radius: 5px;
  cursor: pointer;
  transition: background 0.5s, box-shadow 0.5s, transform 0.2s;
}
button:hover {
  background: var(--accent-hover);
  transform: scale(1.05);
}
#settings-menu {
  position: absolute;
  top: 50px;
  right: 50px;
  display: none;
  flex-direction: column;
  gap: 10px;
  background: #222;
  padding: 15px;
  border-radius: 10px;
  border: 2px solid var(--accent);
  transition: opacity 0.25s;
  opacity: 0;
}
#settings-menu.show {
  display: flex;
  opacity: 1;
}
</style>
</head>
<body>

<div id="avatar-container">
  <img src="https://via.placeholder.com/300" alt="Avatar" id="avatar">
</div>
<div id="size-display">100%</div>

<div id="controls">
  <input type="range" id="scale-input" min="50" max="150" value="100">
  <button id="settings-btn">الإعدادات ⚙️</button>
  <div id="settings-menu">
    <input type="color" id="color-picker" value="#ff8c00">
    <button id="sound-btn">تشغيل/إيقاف الصوت 🔊</button>
  </div>
</div>

<audio id="player" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3"></audio>

<script>
// العناصر الأساسية
const avatar=document.getElementById("avatar");
const scaleInput=document.getElementById("scale-input");
const sizeDisplay=document.getElementById("size-display");
const settingsBtn=document.getElementById("settings-btn");
const settingsMenu=document.getElementById("settings-menu");
const colorPicker=document.getElementById("color-picker");
const player=document.getElementById("player");
const buttons=[settingsBtn];

// تدرج RGB بطيء ومتموج للأزرار والإطار فقط
let colorPhase=0;
function smoothRGB(){
  colorPhase+=0.002;
  const r=Math.round(255 * (Math.sin(colorPhase) * 0.5 + 0.5));
  const g=Math.round(255 * (Math.sin(colorPhase + 2) * 0.5 + 0.5));
  const b=Math.round(255 * (Math.sin(colorPhase + 4) * 0.5 + 0.5));
  const color=`rgb(${r},${g},${b})`;
  document.documentElement.style.setProperty('--accent',color);
  document.documentElement.style.setProperty('--accent-hover',color);
  requestAnimationFrame(smoothRGB);
}
// لا نشغلها مباشرة عند الفتح، يبدأ اللون الابتدائي
window.addEventListener("load",()=>{
  const initialColor="#ff8c00";
  document.documentElement.style.setProperty('--accent',initialColor);
  document.documentElement.style.setProperty('--accent-hover',initialColor);
  colorPicker.value=initialColor;
});

// تحديث حجم الصورة مع السلايدر
scaleInput.addEventListener("input",(e)=>{
  let v=e.target.value;
  avatar.style.transform=`scale(${v/100})`;
  sizeDisplay.textContent=v+"%";
});

// فتح وإغلاق قائمة الإعدادات
settingsBtn.addEventListener("click",()=>{
  if(settingsMenu.classList.contains("show")){
    settingsMenu.classList.remove("show");
    setTimeout(()=>settingsMenu.style.display="none",250);
    settingsBtn.classList.remove("active");
  } else {
    settingsMenu.style.display="flex";
    setTimeout(()=>settingsMenu.classList.add("show"),10);
    settingsBtn.classList.add("active");
  }
});
document.addEventListener("click",(e)=>{
  if(!settingsMenu.contains(e.target) && e.target!==settingsBtn){
    settingsMenu.classList.remove("show");
    setTimeout(()=>settingsMenu.style.display="none",250);
    settingsBtn.classList.remove("active");
  }
});

// تغيير اللون من القائمة فقط على الإطار والأزرار
colorPicker.addEventListener("input",(e)=>{
  const c=e.target.value;
  document.documentElement.style.setProperty('--accent',c);
  document.documentElement.style.setProperty('--accent-hover',c);
});

// الصوت وزر التشغيل
document.getElementById("sound-btn").addEventListener("click",()=>{
  if(player.paused){player.play();}
  else{player.pause();}
});

// بدء تدرج RGB بعد اختيار اللون اليدوي
colorPicker.addEventListener("change",()=>{
  smoothRGB();
});
</script>

</body>
</html>
